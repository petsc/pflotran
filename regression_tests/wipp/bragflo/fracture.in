! 9.6 Test Case #6-c. Fracturing of Interbeds.
! Fracture in marker-beds test case to compare against BRAGFLO.
! For more descriptions of the problem please read case_6-c.docx

!======== flow mode ========
SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
    MODE GENERAL
      OPTIONS
        ITOL_RELATIVE_UPDATE 1.d-30
        TWO_PHASE_ENERGY_DOF TEMPERATURE
        GAS_COMPONENT_FORMULA_WEIGHT 2.01588d0 ! kg/kmol
        MAXIMUM_PRESSURE_CHANGE 5.D3
        TOUGH2_ITOL_SCALED_RESIDUAL 1.d-5
        ISOTHERMAL
      /
    /
  /
END

SUBSURFACE

REGRESSION
  CELLS_PER_PROCESS 2
END

FLUID_PROPERTY
  PHASE LIQUID
  DIFFUSION_COEFFICIENT 0.0d0
END

FLUID_PROPERTY
  PHASE GAS
  DIFFUSION_COEFFICIENT 0.0d0
END

EOS WATER
  DENSITY EXPONENTIAL 1.2200E+03 101325.d0 3.1000E-10
  VISCOSITY CONSTANT 2.10000E-03
  ENTHALPY CONSTANT 1.8890d6
/

EOS GAS
  VISCOSITY CONSTANT 8.93389E-06
  HENRYS_CONSTANT CONSTANT 1.d10
/

NEWTON_SOLVER FLOW
  RTOL 1.d-30
  ATOL 1.d-30
  STOL 1.d-30
  MAXIT 20
END

REGION injection_point
  BLOCK 3 3 1 1 1 1    ! WELL DATA in BF
/

FLOW_CONDITION well  ! INJQ in BF
  TYPE
    RATE mass_rate
  /
  SYNC_TIMESTEP_WITH_UPDATE
  RATE LIST
    TIME_UNITS y
    DATA_UNITS kg/s kg/s MW
    0.d0 1.d-5 0.d0 0.d0
    5.d-1 -5.d-6 0.d0 0.d0
  /
/

SOURCE_SINK well
  FLOW_CONDITION well
  REGION injection_point
/

!======== discretization ========
GRID
  TYPE structured
  NXYZ 10 1 1
  DXYZ
  10*10
  1*10
  1*1
  /
END

!======== regions & strata ========
REGION all
  COORDINATES
    -1.d20 -1.d20 -1.d20
     1.d20 1.d20 1.d20
  /
/

!======== boundary regions  ========

REGION R_MB138
  BLOCK 1 6 1 1 1 1
END

REGION R_MB138_2
  BLOCK 6 10 1 1 1 1
END

!======== materials  ========

MATERIAL_PROPERTY S_MB138
  ID 1
  TORTUOSITY 1.d0
  POROSITY 1.10000d-02
  ROCK_DENSITY 999.d0
  THERMAL_CONDUCTIVITY_DRY 0.999d0
  THERMAL_CONDUCTIVITY_WET 0.999d0
  HEAT_CAPACITY 999.d0
  SOIL_COMPRESSIBILITY_FUNCTION BRAGFLO
  BULK_COMPRESSIBILITY 8.263d-11
  SOIL_REFERENCE_PRESSURE INITIAL_PRESSURE
  CHARACTERISTIC_CURVES SF_MB138
  PERMEABILITY
    PERM_ISO_LOG10 -18.89d0
  /

  WIPP-FRACTURE
    INITIATING_PRESSURE 2.000000d+05
    ALTERED_PRESSURE 3.800000d+06
    MAXIMUM_FRACTURE_POROSITY 5.000000E-02
    FRACTURE_EXPONENT 1.576329E+01
    ALTER_PERM_X
    ALTER_PERM_Y
  /

END

CHARACTERISTIC_CURVES SF_MB138
  SATURATION_FUNCTION BROOKS_COREY
    SMOOTH
    LAMBDA 6.4360d-01
    ALPHA  1.0264d-06
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    MAX_CAPILLARY_PRESSURE 1.00000d+08
  /
  PERMEABILITY_FUNCTION BURDINE_BC_LIQ
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
  /
  PERMEABILITY_FUNCTION BURDINE_BC_GAS
    LAMBDA 6.43600d-01
    LIQUID_RESIDUAL_SATURATION 8.36200d-02
    GAS_RESIDUAL_SATURATION    7.71100d-02
  /
END

STRATA
	MATERIAL S_MB138
	REGION R_MB138
END

STRATA
	MATERIAL S_MB138
	REGION R_MB138_2
END

!=========================== output options ===================================
OUTPUT
!  PERIODIC_OBSERVATION TIMESTEP 1
!  TIMES y .0010 .0030 .0050 .0100 .0300 .0500 .1000 .3000 .5000\
!   .5010 .5030 .5050 .5100 .5300 .5500 .6000 .8000 1
!  FORMAT HDF5
  VARIABLES
    TEMPERATURE
    LIQUID_PRESSURE
    GAS_PRESSURE
    MINERAL_POROSITY
    EFFECTIVE_POROSITY
    LIQUID_DENSITY
    GAS_DENSITY
    LIQUID_SATURATION
    GAS_SATURATION
    GAS_MOLE_FRACTIONS
    PERMEABILITY_X
    PERMEABILITY_Y
    PERMEABILITY_Z
    LIQUID_ENERGY
    SOIL_REFERENCE_PRESSURE
  /
/
!=========================== times ============================================
TIME
  FINAL_TIME 1 y ! 0.317... y
  INITIAL_TIMESTEP_SIZE 1.00E+00 s
  MAXIMUM_TIMESTEP_SIZE 1 y
/

FLOW_CONDITION FC_MB138
  TYPE
    LIQUID_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 1.000000E+06
  MOLE_FRACTION 1E-7
  TEMPERATURE 2.70000E+01
/

FLOW_CONDITION FC_MB138_2
  TYPE
    LIQUID_PRESSURE DIRICHLET
    MOLE_FRACTION DIRICHLET
    TEMPERATURE DIRICHLET
  /
  LIQUID_PRESSURE 2.000000E+06
  MOLE_FRACTION 1E-7
  TEMPERATURE 2.70000E+01
/

INITIAL_CONDITION
  FLOW_CONDITION FC_MB138
  REGION R_MB138
END

INITIAL_CONDITION
  FLOW_CONDITION FC_MB138_2
  REGION R_MB138_2
END

END_SUBSURFACE
